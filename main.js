!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible",modalSpan:".modal__span"};class t{constructor(e){this._popupElement=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this),this._closePopupOutside=this._closePopupOutside.bind(this),this._closeButton=this._popupElement.querySelector(".modal__close"),this._modalButton=this._popupElement.querySelector(".modal__button")}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose),this._popupElement.addEventListener("mousedown",this._closePopupOutside)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose),this._popupElement.removeEventListener("mousedown",this._closePopupOutside)}_handleEscClose(e){"Escape"===e.key&&this.close()}_closePopupOutside(e){e.target===this._popupElement&&this.close()}renderLoading(e){this._modalButton.textContent=e}setEventListeners(){this._closeButton.addEventListener("click",(()=>this.close()))}}class s extends t{constructor(e,t){super(e),this._submitButton=this._popupElement.querySelector(".modal__button"),this._handleFormSubmit=t,this._popupForm=this._popupElement.querySelector(".modal__form"),this._inputList=this._popupForm.querySelectorAll(".modal__input")}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}_handleSubmit=e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close(),this._popupForm.reset()};setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",this._handleSubmit)}}class i{constructor(e,t){let{items:s,renderer:i}=e;this._items=s,this._renderer=i,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class n{constructor(e,t,s,i,n){this._data=e,this.isLiked=e.isLiked,this.id=e._id,this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteButton=i,this._handleLikeButton=n}_setEventListeners(){this._likeButton.addEventListener("click",(()=>this._handleLikeButton(this))),this._deleteButton.addEventListener("click",(()=>this._handleDeleteButton(this))),this._cardImageEl.addEventListener("click",(()=>{this._handleImageClick(this._link,this._name)}))}_handleLikes(){this.isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}handleIsLiked(e){this.isLiked=e,this._handleLikes()}deleteCard(){this._cardElement.remove(),this._element=null}getCardElement(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardImageEl=this._cardElement.querySelector(".card__image"),this._cardTitleEl=this._cardElement.querySelector(".card__title"),this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name,this._cardTitleEl.textContent=this._name,this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._setEventListeners(),this._handleLikes(),this._cardElement}}var o=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._modalSpan=e.modalSpan,this._form=t}_resetSubmitButton(){this._submitButton.classList.add(this._inactiveButtonClass)}hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t&&(t.textContent="",t.classList.remove(this._inputErrorClass))}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t&&(t.textContent=e.validationMessage,t.classList.add(this._errorClass))}toggleButtonState(){this._isFormValid()?(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1):(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0)}_isFormValid(){return this._inputEls.every((e=>e.validity.valid))}_checkInputValidity(e){e.validity.valid?this.hideInputError(e):this._showInputError(e)}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._inputEls.forEach((e=>{this.hideInputError(e)})),this.toggleButtonState()}};const r=document.getElementById("avatar-button"),l=document.getElementById("profile-edit-button"),a=document.getElementById("profile-add-button"),d=document.getElementById("profile-image-modal"),h=document.getElementById("profile-title-input"),c=document.getElementById("profile-description-input"),u=document.forms["profile-image-form"],_=document.forms["profile-form"],m=document.forms["add-card-form"],p=new class extends t{constructor(e){super(e),this._imageElement=this._popupElement.querySelector(".modal__preview-image"),this._captionElement=this._popupElement.querySelector(".modal__image-text")}open(e){let{name:t,link:s}=e;this._imageElement.src=s,this._imageElement.alt=t,this._captionElement.textContent=t,super.open()}}("#image-modal");p.setEventListeners();const E=new class extends t{constructor(e){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._popupDeleteButton=this._popupElement.querySelector(".modal__button")}handleDelete(e){this._handleDeleteSubmit=e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleDeleteSubmit()}))}}("#delete-card-modal");E.setEventListeners();const g=new s("#profile-edit-modal",(e=>{var t;t=e,console.log(t),g.renderLoading("Saving..."),v.updateUserInfo(t).then((e=>{f.setUserInfo(e),q.resetValidation()})).catch((e=>{console.log(e)})).finally((()=>{g.close(),g.renderLoading("Save")}))}));g.setEventListeners();const v=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>this._handleResponse(e)))}updateUserInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:`${e.name}`,about:`${e.description}`})}).then((e=>this._handleResponse(e)))}updateProfileImage(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>this._handleResponse(e)))}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>this._handleResponse(e)))}createCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",body:JSON.stringify({name:`${e.title}`,link:`${e.url}`}),headers:this._headers}).then((e=>this._handleResponse(e)))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>this._handleResponse(e)))}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then((e=>this._handleResponse(e)))}deleteLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then((e=>this._handleResponse(e)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"2db58c83-3523-4135-8564-2660432887a4","Content-Type":"application/json"}}),f=new class{constructor(e){let{titleSelector:t,descriptionSelector:s,profileImage:i}=e;this._titleElement=document.querySelector(t),this._descriptionElement=document.querySelector(s),this._imageSelector=document.querySelector(i)}getUserInfo(){return{name:this._titleElement.textContent,about:this._descriptionElement.textContent}}setUserInfo(e){this._titleElement.textContent=e.name,this._descriptionElement.textContent=e.about}setProfileImage(e){this._imageSelector.src=e.avatar}}({titleSelector:".profile__title",descriptionSelector:".profile__description",profileImage:".profile__image"}),L=new s("#add-card-modal",(e=>{var t;t=e,L.renderLoading("Loading..."),v.createCard(t).then((e=>{k(e),L.close(),U.resetValidation()})).finally((()=>{L.renderLoading("Save")})),console.log(e)}));L.setEventListeners();const b=new s("#profile-image-modal",(e=>{var t;console.log(e),t=e.url,b.renderLoading("Loading..."),v.updateProfileImage(t).then((e=>{f.setProfileImage(e),b.close(),u.resetValidation(),B.disableSubmit()})).catch((e=>{console.log(`Unable to process request, ${e}`)})).finally((()=>{b.renderLoading("Save")}))}));let S;function k(e){const t=function(e){return new n(e,"#card-template",y,I,C).getCardElement()}(e);S.addItem(t)}function y(e,t){p.open({name:t,link:e})}function I(e){E.open(),console.log(e.id),E.handleDelete((()=>{E.renderLoading("Saving..."),v.deleteCard(e.id).then((()=>{e.deleteCard()})).catch((e=>{console.log(e)})).finally((()=>{E.close(),E.renderLoading("Yes")}))}))}function C(e){e.isLiked&&v.deleteLike(e.id).then((()=>{e.handleIsLiked(!1)})).catch((e=>{console.log(e)})),e.isLiked||v.likeCard(e.id).then((()=>{e.handleIsLiked(!0)})).catch((e=>{console.log(`Unable to process request, ${e}`)}))}b.setEventListeners(),l.addEventListener("click",(()=>{q.hideInputError(_);const{name:e,about:t}=f.getUserInfo();h.value=e,c.value=t,g.open(),q.resetValidation()})),d.addEventListener("click",(()=>{q.hideInputError(u);const{url:e}=f.getUserInfo()})),a.addEventListener("click",(()=>{L.open(),U.resetValidation()})),r.addEventListener("click",(()=>{b.open()})),v.getUserInfo().then((e=>{f.setProfileImage(e),f.setUserInfo({name:e.name,about:e.about})})).catch((e=>{console.log(`Unable to process request, ${e}`)})),v.getInitialCards().then((e=>{console.log(e),S=new i({items:e,renderer:e=>{k(e)}},".cards__list"),S.renderItems(e)})).catch((e=>{console.log(`Unable to process request, ${e}`)}));const B=new o(e,u),q=new o(e,_),U=new o(e,m);q.enableValidation(),U.enableValidation(),B.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNHb0IsY0FDQWxCLE1BQU11RCxJQUNMckQsRUFBU3lDLGdCQUFnQlksR0FDekJyRCxFQUFTQyxZQUFZLENBQ25CeEcsS0FBTTRKLEVBQVM1SixLQUNmNkgsTUFBTytCLEVBQVMvQixPQUNoQixJQUVIbkIsT0FBT0MsSUFDTlYsUUFBUUMsSUFBSSw4QkFBOEJTLElBQU0sSUFHcERSLEVBQ0crQixrQkFDQTdCLE1BQU13RCxJQUNMNUQsUUFBUUMsSUFBSTJELEdBRVpKLEVBQWMsSUFBSXBKLEVBQ2hCLENBQ0VHLE1BQU9xSixFQUNQcEosU0FBV2lKLElBQ1RQLEVBQVdPLEVBQVMsR0FHeEIsZ0JBRUZELEVBQVk1SSxZQUFZZ0osRUFBTSxJQUUvQm5ELE9BQU9DLElBQ05WLFFBQVFDLElBQUksOEJBQThCUyxJQUFNLElBSXBELE1BQU00QyxFQUF3QixJQUFJTyxFQUFjN00sRUFBUWlJLEdBQ2xEdUIsRUFBdUIsSUFBSXFELEVBQWM3TSxFQUFRbUksR0FDakRnRSxFQUFtQixJQUFJVSxFQUFjN00sRUFBUW9JLEdBRW5Eb0IsRUFBcUJoQyxtQkFDckIyRSxFQUFpQjNFLG1CQUNqQjhFLEVBQXNCOUUsa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwRGVsZXRlQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG4gIG1vZGFsU3BhbjogXCIubW9kYWxfX3NwYW5cIixcbn07XG5cbmV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxuICB9LFxuXTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2Nsb3NlUG9wdXBPdXRzaWRlID0gdGhpcy5fY2xvc2VQb3B1cE91dHNpZGUuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcbiAgICB0aGlzLl9tb2RhbEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9jbG9zZVBvcHVwT3V0c2lkZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICBcIm1vdXNlZG93blwiLFxuICAgICAgdGhpcy5fY2xvc2VQb3B1cE91dHNpZGVcbiAgICApO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgX2Nsb3NlUG9wdXBPdXRzaWRlKGUpIHtcbiAgICBpZiAoZS50YXJnZXQgPT09IHRoaXMuX3BvcHVwRWxlbWVudCkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIHJlbmRlckxvYWRpbmcoYnV0dG9uVGV4dCkge1xuICAgIHRoaXMuX21vZGFsQnV0dG9uLnRleHRDb250ZW50ID0gYnV0dG9uVGV4dDtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLmNsb3NlKCkpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGZvcm1WYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGZvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gZm9ybVZhbHVlcztcbiAgfVxuXG4gIF9oYW5kbGVTdWJtaXQgPSAoZXZ0KSA9PiB7XG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICB0aGlzLmNsb3NlKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gIH07XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9oYW5kbGVTdWJtaXQpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgZGF0YSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVEZWxldGVCdXR0b24sXG4gICAgaGFuZGxlTGlrZUJ1dHRvblxuICApIHtcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcbiAgICB0aGlzLmlzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7XG4gICAgdGhpcy5pZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uID0gaGFuZGxlRGVsZXRlQnV0dG9uO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b24gPSBoYW5kbGVMaWtlQnV0dG9uO1xuICB9XG4gIC8vICEgfHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXx8XG4gIC8vICEgfHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFdmVudExpc3RlbmVyczsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8XG4gIC8vICEgfHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXx8XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKHRoaXMpXG4gICAgKTtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b24odGhpcylcbiAgICApO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX2xpbmssIHRoaXMuX25hbWUpO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gISB8fC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfHxcbiAgLy8gISB8fCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50SGFuZGxlcnM7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHxcbiAgLy8gISB8fC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfHxcblxuICBfaGFuZGxlTGlrZXMoKSB7XG4gICAgaWYgKHRoaXMuaXNMaWtlZCkge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKGBjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKGBjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVgKTtcbiAgICB9XG4gIH1cblxuICBoYW5kbGVJc0xpa2VkKGlzTGlrZWQpIHtcbiAgICB0aGlzLmlzTGlrZWQgPSBpc0xpa2VkO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VzKCk7XG4gIH1cblxuICBkZWxldGVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICB9XG5cbiAgLy8gISB8fC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfHxcbiAgLy8gISB8fCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmV0dXJuQ2FyZDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHxcbiAgLy8gISB8fC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfHxcbiAgZ2V0Q2FyZEVsZW1lbnQoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgdGhpcy5fY2FyZEltYWdlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5jYXJkX19kZWxldGUtYnV0dG9uXCJcbiAgICApO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9oYW5kbGVMaWtlcygpO1xuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxufVxuIiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xuICAgIHRoaXMuX21vZGFsU3BhbiA9IHNldHRpbmdzLm1vZGFsU3BhbjtcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XG4gIH1cblxuICBfcmVzZXRTdWJtaXRCdXR0b24oKSB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIH1cblxuICBoaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgaWYgKGVycm9yTWVzc2FnZUVsKSB7XG4gICAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgfVxuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBpZiAoZXJyb3JNZXNzYWdlRWwpIHtcbiAgICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gICAgfVxuICB9XG5cbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgY29uc3QgaXNGb3JtVmFsaWRSZXN1bHQgPSB0aGlzLl9pc0Zvcm1WYWxpZCgpO1xuXG4gICAgaWYgKCFpc0Zvcm1WYWxpZFJlc3VsdCkge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIF9pc0Zvcm1WYWxpZCgpIHtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRFbHMuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICB0aGlzLmhpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xuICAgIH0pO1xuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xuIiwiaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCB7IGNvbmZpZyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcbmltcG9ydCB7IGluaXRpYWxDYXJkcyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcbmltcG9ydCBQb3B1cERlbGV0ZUNhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBEZWxldGVDYXJkLmpzXCI7XG5cbmNvbnN0IHByb2ZpbGVJbWFnZUVkaXRCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImF2YXRhci1idXR0b25cIik7XG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcbmNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGUtYWRkLWJ1dHRvblwiKTtcbmNvbnN0IHByb2ZpbGVFZGl0SW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGUtaW1hZ2UtbW9kYWxcIik7XG5jb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXG4gIFwicHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXG4pO1xuXG5jb25zdCBwcm9maWxlSW1hZ2VGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWltYWdlLWZvcm1cIl07XG5jb25zdCBwcm9maWxlRWRpdEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcInByb2ZpbGUtZm9ybVwiXTtcbmNvbnN0IGFkZENhcmRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zW1wiYWRkLWNhcmQtZm9ybVwiXTtcblxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjaW1hZ2UtbW9kYWxcIik7XG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBkZWxldGVJbWFnZU1vZGFsID0gbmV3IFBvcHVwRGVsZXRlQ2FyZChcIiNkZWxldGUtY2FyZC1tb2RhbFwiKTtcbmRlbGV0ZUltYWdlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcbiAgKGZvcm1EYXRhKSA9PiB7XG4gICAgaGFuZGxlRWRpdFByb2ZpbGVTdWJtaXQoZm9ybURhdGEpO1xuICB9XG4pO1xucHJvZmlsZUVkaXRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vL0RlY2xhcmUgQVBJIGNsYXNzOlxuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCIyZGI1OGM4My0zNTIzLTQxMzUtODU2NC0yNjYwNDMyODg3YTRcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG4vL0RlY2xhcmUgVXNlckluZm8gQ2xhc3M6XG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIHRpdGxlU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXG4gIGRlc2NyaXB0aW9uU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXG4gIHByb2ZpbGVJbWFnZTogXCIucHJvZmlsZV9faW1hZ2VcIixcbn0pO1xuXG4vL0RlY2xhcmUgUG9wdXBXaXRoRm9ybSBmb3IgYWRkQ2FyZE1vZGFsOlxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYWRkLWNhcmQtbW9kYWxcIiwgKGZvcm1EYXRhKSA9PiB7XG4gIGhhbmRsZUFkZENhcmRTdWJtaXQoZm9ybURhdGEpO1xuICBjb25zb2xlLmxvZyhmb3JtRGF0YSk7XG59KTtcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vL2RlY2xhcmUgRWRpdCBJbWFnZSBNb2RhbFxuY29uc3QgcHJvZmlsZUltYWdlTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjcHJvZmlsZS1pbWFnZS1tb2RhbFwiLFxuICAoZm9ybURhdGEpID0+IHtcbiAgICBjb25zb2xlLmxvZyhmb3JtRGF0YSk7XG4gICAgaGFuZGxlQ2hhbmdlUHJvZmlsZVBpY3R1cmUoZm9ybURhdGEudXJsKTtcbiAgfVxuKTtcbnByb2ZpbGVJbWFnZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vRGVjbGFyZSBTZWN0aW9uIGZvciBJbml0aWFsIENhcmRzXG5sZXQgY2FyZFNlY3Rpb247XG5cbi8vUmVuZGVyQ2FyZEZ1bmN0aW9uXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBjcmVhdGVDYXJkKGNhcmREYXRhKTtcbiAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkKTtcbn1cbi8vQ3JlYXRlIENhcmQgRnVuY3Rpb25cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgIGNhcmREYXRhLFxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUJ1dHRvbixcbiAgICBoYW5kbGVMaWtlQnV0dG9uXG4gICk7XG4gIHJldHVybiBjYXJkLmdldENhcmRFbGVtZW50KCk7XG59XG4vL0NsaWNrIENhcmQgRnVuY3Rpb25cbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2sobGluaywgbmFtZSkge1xuICBwb3B1cFdpdGhJbWFnZS5vcGVuKHsgbmFtZSwgbGluayB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRWRpdFByb2ZpbGVTdWJtaXQoaW5wdXRWYWx1ZXMpIHtcbiAgY29uc29sZS5sb2coaW5wdXRWYWx1ZXMpO1xuICBwcm9maWxlRWRpdE1vZGFsLnJlbmRlckxvYWRpbmcoXCJTYXZpbmcuLi5cIik7XG4gIGFwaVxuICAgIC51cGRhdGVVc2VySW5mbyhpbnB1dFZhbHVlcylcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMpO1xuICAgICAgcHJvZmlsZUVkaXRWYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHByb2ZpbGVFZGl0TW9kYWwuY2xvc2UoKTtcbiAgICAgIHByb2ZpbGVFZGl0TW9kYWwucmVuZGVyTG9hZGluZyhcIlNhdmVcIik7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoaW5wdXRWYWx1ZXMpIHtcbiAgYWRkQ2FyZFBvcHVwLnJlbmRlckxvYWRpbmcoXCJMb2FkaW5nLi4uXCIpO1xuICBhcGlcbiAgICAuY3JlYXRlQ2FyZChpbnB1dFZhbHVlcylcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICByZW5kZXJDYXJkKHJlcyk7XG4gICAgICBhZGRDYXJkUG9wdXAuY2xvc2UoKTtcbiAgICAgIGFkZENhcmRWYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBhZGRDYXJkUG9wdXAucmVuZGVyTG9hZGluZyhcIlNhdmVcIik7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUJ1dHRvbihjYXJkKSB7XG4gIGRlbGV0ZUltYWdlTW9kYWwub3BlbigpO1xuICBjb25zb2xlLmxvZyhjYXJkLmlkKTtcbiAgZGVsZXRlSW1hZ2VNb2RhbC5oYW5kbGVEZWxldGUoKCkgPT4ge1xuICAgIGRlbGV0ZUltYWdlTW9kYWwucmVuZGVyTG9hZGluZyhcIlNhdmluZy4uLlwiKTtcbiAgICBhcGlcbiAgICAgIC5kZWxldGVDYXJkKGNhcmQuaWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQuZGVsZXRlQ2FyZCgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBkZWxldGVJbWFnZU1vZGFsLmNsb3NlKCk7XG4gICAgICAgIGRlbGV0ZUltYWdlTW9kYWwucmVuZGVyTG9hZGluZyhcIlllc1wiKTtcbiAgICAgIH0pO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlTGlrZUJ1dHRvbihjYXJkKSB7XG4gIGlmIChjYXJkLmlzTGlrZWQpIHtcbiAgICBhcGlcbiAgICAgIC5kZWxldGVMaWtlKGNhcmQuaWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQuaGFuZGxlSXNMaWtlZChmYWxzZSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pO1xuICB9XG4gIGlmICghY2FyZC5pc0xpa2VkKSB7XG4gICAgYXBpXG4gICAgICAubGlrZUNhcmQoY2FyZC5pZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY2FyZC5oYW5kbGVJc0xpa2VkKHRydWUpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBVbmFibGUgdG8gcHJvY2VzcyByZXF1ZXN0LCAke2Vycn1gKTtcbiAgICAgIH0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUNoYW5nZVByb2ZpbGVQaWN0dXJlKGlucHV0VXJsKSB7XG4gIHByb2ZpbGVJbWFnZU1vZGFsLnJlbmRlckxvYWRpbmcoXCJMb2FkaW5nLi4uXCIpO1xuICBhcGlcbiAgICAudXBkYXRlUHJvZmlsZUltYWdlKGlucHV0VXJsKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFByb2ZpbGVJbWFnZShyZXMpO1xuICAgICAgcHJvZmlsZUltYWdlTW9kYWwuY2xvc2UoKTtcbiAgICAgIHByb2ZpbGVJbWFnZUZvcm0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gICAgICBwcm9maWxlSW1hZ2VWYWxpZGF0b3IuZGlzYWJsZVN1Ym1pdCgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGBVbmFibGUgdG8gcHJvY2VzcyByZXF1ZXN0LCAke2Vycn1gKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHByb2ZpbGVJbWFnZU1vZGFsLnJlbmRlckxvYWRpbmcoXCJTYXZlXCIpO1xuICAgIH0pO1xufVxuXG4vL1Byb2ZpbGVFZGl0QnV0dG9uRXZlbnRMaXN0ZW5lcnNcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHByb2ZpbGVFZGl0VmFsaWRhdG9yLmhpZGVJbnB1dEVycm9yKHByb2ZpbGVFZGl0Rm9ybSk7XG4gIGNvbnN0IHsgbmFtZSwgYWJvdXQgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gbmFtZTtcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBhYm91dDtcbiAgcHJvZmlsZUVkaXRNb2RhbC5vcGVuKCk7XG4gIHByb2ZpbGVFZGl0VmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xufSk7XG4vL1Byb2ZpbGVFZGl0SW1hZ2VFdmVudExpc3RlbmVyc1xucHJvZmlsZUVkaXRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBwcm9maWxlRWRpdFZhbGlkYXRvci5oaWRlSW5wdXRFcnJvcihwcm9maWxlSW1hZ2VGb3JtKTtcbiAgY29uc3QgeyB1cmwgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG59KTtcbi8vQWRkIENhcmQgQnV0dG9uIEV2ZW50IExpc3RlbmVyc1xuYWRkTmV3Q2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhZGRDYXJkUG9wdXAub3BlbigpO1xuICBhZGRDYXJkVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xufSk7XG5cbnByb2ZpbGVJbWFnZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgcHJvZmlsZUltYWdlTW9kYWwub3BlbigpO1xufSk7XG5cbmFwaVxuICAuZ2V0VXNlckluZm8oKVxuICAudGhlbigodXNlckRhdGEpID0+IHtcbiAgICB1c2VySW5mby5zZXRQcm9maWxlSW1hZ2UodXNlckRhdGEpO1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsXG4gICAgICBhYm91dDogdXNlckRhdGEuYWJvdXQsXG4gICAgfSk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5sb2coYFVuYWJsZSB0byBwcm9jZXNzIHJlcXVlc3QsICR7ZXJyfWApO1xuICB9KTtcblxuYXBpXG4gIC5nZXRJbml0aWFsQ2FyZHMoKVxuICAudGhlbigoY2FyZHMpID0+IHtcbiAgICBjb25zb2xlLmxvZyhjYXJkcyk7XG5cbiAgICBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgICAge1xuICAgICAgICBpdGVtczogY2FyZHMsXG4gICAgICAgIHJlbmRlcmVyOiAoY2FyZERhdGEpID0+IHtcbiAgICAgICAgICByZW5kZXJDYXJkKGNhcmREYXRhKTtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBcIi5jYXJkc19fbGlzdFwiXG4gICAgKTtcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcyhjYXJkcyk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5sb2coYFVuYWJsZSB0byBwcm9jZXNzIHJlcXVlc3QsICR7ZXJyfWApO1xuICB9KTtcblxuLy8gRm9ybSBWYWxpZGF0b3JzXG5jb25zdCBwcm9maWxlSW1hZ2VWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHByb2ZpbGVJbWFnZUZvcm0pO1xuY29uc3QgcHJvZmlsZUVkaXRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHByb2ZpbGVFZGl0Rm9ybSk7XG5jb25zdCBhZGRDYXJkVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBhZGRDYXJkRm9ybUVsZW1lbnQpO1xuXG5wcm9maWxlRWRpdFZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hZGRDYXJkVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbnByb2ZpbGVJbWFnZVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLm1vZGFsX19wcmV2aWV3LWltYWdlXCJcbiAgICApO1xuICAgIHRoaXMuX2NhcHRpb25FbGVtZW50ID1cbiAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZS10ZXh0XCIpO1xuICB9XG4gIG9wZW4oeyBuYW1lLCBsaW5rIH0pIHtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuc3JjID0gbGluaztcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWx0ID0gbmFtZTtcbiAgICB0aGlzLl9jYXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwRGVsZXRlQ2FyZCBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5fcG9wdXBEZWxldGVCdXR0b24gPVxyXG4gICAgICB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlRGVsZXRlKGhhbmRsZURlbGV0ZVN1Ym1pdCkge1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlU3VibWl0ID0gaGFuZGxlRGVsZXRlU3VibWl0O1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVTdWJtaXQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZVJlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIC8vIGlmIHRoZSBzZXJ2ZXIgcmV0dXJucyBhbiBlcnJvciwgcmVqZWN0IHRoZSBwcm9taXNlXHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlVXNlckluZm8oZm9ybURhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBgJHtmb3JtRGF0YS5uYW1lfWAsXHJcbiAgICAgICAgYWJvdXQ6IGAke2Zvcm1EYXRhLmRlc2NyaXB0aW9ufWAsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVQcm9maWxlSW1hZ2UodXJsKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogdXJsLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjcmVhdGVDYXJkKHNhbXBsZUNhcmQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGAke3NhbXBsZUNhcmQudGl0bGV9YCxcclxuICAgICAgICBsaW5rOiBgJHtzYW1wbGVDYXJkLnVybH1gLFxyXG4gICAgICB9KSxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgbGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUxpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcyk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IHRpdGxlU2VsZWN0b3IsIGRlc2NyaXB0aW9uU2VsZWN0b3IsIHByb2ZpbGVJbWFnZSB9KSB7XG4gICAgdGhpcy5fdGl0bGVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aXRsZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9kZXNjcmlwdGlvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRlc2NyaXB0aW9uU2VsZWN0b3IpO1xuICAgIHRoaXMuX2ltYWdlU2VsZWN0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVJbWFnZSk7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fdGl0bGVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgYWJvdXQ6IHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8oaW5wdXRWYWx1ZXMpIHtcbiAgICB0aGlzLl90aXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dFZhbHVlcy5uYW1lO1xuXG4gICAgdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRWYWx1ZXMuYWJvdXQ7XG4gIH1cbiAgc2V0UHJvZmlsZUltYWdlKGltYWdlKSB7XG4gICAgdGhpcy5faW1hZ2VTZWxlY3Rvci5zcmMgPSBpbWFnZS5hdmF0YXI7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJjb25maWciLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIm1vZGFsU3BhbiIsIlBvcHVwIiwiY29uc3RydWN0b3IiLCJwb3B1cFNlbGVjdG9yIiwidGhpcyIsIl9wb3B1cEVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwiX2Nsb3NlUG9wdXBPdXRzaWRlIiwiX2Nsb3NlQnV0dG9uIiwiX21vZGFsQnV0dG9uIiwib3BlbiIsImNsYXNzTGlzdCIsImFkZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbG9zZSIsInJlbW92ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJlIiwidGFyZ2V0IiwicmVuZGVyTG9hZGluZyIsImJ1dHRvblRleHQiLCJ0ZXh0Q29udGVudCIsInNldEV2ZW50TGlzdGVuZXJzIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9zdWJtaXRCdXR0b24iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9wb3B1cEZvcm0iLCJfaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsIl9nZXRJbnB1dFZhbHVlcyIsImZvcm1WYWx1ZXMiLCJmb3JFYWNoIiwiaW5wdXQiLCJuYW1lIiwidmFsdWUiLCJfaGFuZGxlU3VibWl0IiwicHJldmVudERlZmF1bHQiLCJyZXNldCIsIlNlY3Rpb24iLCJfcmVmIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsIkNhcmQiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZUJ1dHRvbiIsImhhbmRsZUxpa2VCdXR0b24iLCJfZGF0YSIsImlzTGlrZWQiLCJpZCIsIl9pZCIsIl9uYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VCdXR0b24iLCJfZGVsZXRlQnV0dG9uIiwiX2NhcmRJbWFnZUVsIiwiX2hhbmRsZUxpa2VzIiwiaGFuZGxlSXNMaWtlZCIsImRlbGV0ZUNhcmQiLCJfY2FyZEVsZW1lbnQiLCJfZWxlbWVudCIsImdldENhcmRFbGVtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsIl9jYXJkVGl0bGVFbCIsInNyYyIsImFsdCIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiX21vZGFsU3BhbiIsIl9mb3JtIiwiX3Jlc2V0U3VibWl0QnV0dG9uIiwiaGlkZUlucHV0RXJyb3IiLCJpbnB1dEVsIiwiZXJyb3JNZXNzYWdlRWwiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiX2lzRm9ybVZhbGlkIiwiZGlzYWJsZWQiLCJfaW5wdXRFbHMiLCJldmVyeSIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiZW5hYmxlVmFsaWRhdGlvbiIsInJlc2V0VmFsaWRhdGlvbiIsInByb2ZpbGVJbWFnZUVkaXRCdXR0b24iLCJnZXRFbGVtZW50QnlJZCIsInByb2ZpbGVFZGl0QnV0dG9uIiwiYWRkTmV3Q2FyZEJ1dHRvbiIsInByb2ZpbGVFZGl0SW1hZ2UiLCJwcm9maWxlVGl0bGVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwicHJvZmlsZUltYWdlRm9ybSIsImZvcm1zIiwicHJvZmlsZUVkaXRGb3JtIiwiYWRkQ2FyZEZvcm1FbGVtZW50IiwicG9wdXBXaXRoSW1hZ2UiLCJfaW1hZ2VFbGVtZW50IiwiX2NhcHRpb25FbGVtZW50IiwiZGVsZXRlSW1hZ2VNb2RhbCIsIl9wb3B1cERlbGV0ZUJ1dHRvbiIsImhhbmRsZURlbGV0ZSIsImhhbmRsZURlbGV0ZVN1Ym1pdCIsIl9oYW5kbGVEZWxldGVTdWJtaXQiLCJwcm9maWxlRWRpdE1vZGFsIiwiZm9ybURhdGEiLCJpbnB1dFZhbHVlcyIsImNvbnNvbGUiLCJsb2ciLCJhcGkiLCJ1cGRhdGVVc2VySW5mbyIsInRoZW4iLCJyZXMiLCJ1c2VySW5mbyIsInNldFVzZXJJbmZvIiwicHJvZmlsZUVkaXRWYWxpZGF0b3IiLCJjYXRjaCIsImVyciIsImZpbmFsbHkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfaGFuZGxlUmVzcG9uc2UiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJkZXNjcmlwdGlvbiIsInVwZGF0ZVByb2ZpbGVJbWFnZSIsInVybCIsImF2YXRhciIsImdldEluaXRpYWxDYXJkcyIsImNyZWF0ZUNhcmQiLCJzYW1wbGVDYXJkIiwidGl0bGUiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsImRlbGV0ZUxpa2UiLCJhdXRob3JpemF0aW9uIiwidGl0bGVTZWxlY3RvciIsImRlc2NyaXB0aW9uU2VsZWN0b3IiLCJwcm9maWxlSW1hZ2UiLCJfdGl0bGVFbGVtZW50IiwiX2Rlc2NyaXB0aW9uRWxlbWVudCIsIl9pbWFnZVNlbGVjdG9yIiwic2V0UHJvZmlsZUltYWdlIiwiaW1hZ2UiLCJhZGRDYXJkUG9wdXAiLCJyZW5kZXJDYXJkIiwiYWRkQ2FyZFZhbGlkYXRvciIsInByb2ZpbGVJbWFnZU1vZGFsIiwiaW5wdXRVcmwiLCJwcm9maWxlSW1hZ2VWYWxpZGF0b3IiLCJkaXNhYmxlU3VibWl0IiwiY2FyZFNlY3Rpb24iLCJjYXJkRGF0YSIsImNhcmQiLCJ1c2VyRGF0YSIsImNhcmRzIiwiRm9ybVZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=